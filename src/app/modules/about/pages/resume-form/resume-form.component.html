<div class="flex flex-col min-h-screen mt-3">
  <mat-stepper class="w-full" [linear]="true" #stepper>
    <!-- Work experience step (restored) -->
    <mat-step [stepControl]="experienceFormGroup" [editable]="true">
      <ng-template matStepLabel>Work experience</ng-template>

      <form [formGroup]="experienceFormGroup">
        <div class="mb-4">
          <button
            mat-raised-button
            color="primary"
            type="button"
            (click)="addExperience()"
          >
            Add experience
          </button>
          <div class="flex justify-end mt-4">
            <button mat-button matStepperNext>Next</button>
          </div>
          <div
            *ngFor="let exp of experiences.controls; let i = index"
            class="mb-4"
          >
            <app-work-experience [group]="exp"></app-work-experience>
            <div class="mt-2">
              <button
                mat-button
                color="warn"
                type="button"
                (click)="removeExperience(i)"
              >
                Remove
              </button>
            </div>
          </div>
        </div>
      </form>

      <div>
        <button mat-button matStepperNext>Next</button>
      </div>
    </mat-step>

    <!-- Technologies step -->
    <mat-step [stepControl]="technologiesFormGroup">
      <ng-template matStepLabel>Technologies</ng-template>
      <form [formGroup]="technologiesFormGroup">
        <app-technologies [group]="technologiesFormGroup"></app-technologies>
        <div class="flex justify-between mt-4">
          <div></div>
          <button
            mat-button
            matStepperNext
            [disabled]="technologiesFormGroup.invalid"
          >
            Next
          </button>
        </div>
      </form>
    </mat-step>

    <!-- Education step (list) -->
    <mat-step [stepControl]="educationFormGroup">
      <ng-template matStepLabel>Education</ng-template>
      <form [formGroup]="educationFormGroup">
        <div class="mb-4">
          <button
            mat-raised-button
            color="primary"
            type="button"
            (click)="addEducation()"
          >
            Add education
          </button>
        </div>
        <div formArrayName="educations">
          <div
            *ngFor="let edu of educations.controls; let i = index"
            class="mb-4 border p-4 rounded"
          >
            <div class="flex justify-between items-center mb-2">
              <h3 class="font-semibold">Education {{ i + 1 }}</h3>
              <button
                mat-icon-button
                color="warn"
                type="button"
                (click)="removeEducation(i)"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>

            <app-education-entry [group]="edu"></app-education-entry>
          </div>
        </div>

        <div class="flex justify-between mt-4">
          <button mat-button matStepperPrevious>Back</button>
          <button
            mat-button
            matStepperNext
            [disabled]="educationFormGroup.invalid"
          >
            Next
          </button>
        </div>
      </form>
    </mat-step>

    <!-- Projects step (list) -->
    <mat-step [stepControl]="projectsFormGroup">
      <ng-template matStepLabel>Projects</ng-template>
      <form [formGroup]="projectsFormGroup">
        <app-projects [group]="projectsFormGroup"></app-projects>
        <div class="flex justify-between mt-4">
          <button mat-button matStepperPrevious>Back</button>
          <button
            mat-button
            matStepperNext
            [disabled]="projectsFormGroup.invalid"
          >
            Next
          </button>
        </div>
      </form>
    </mat-step>

    <!-- Interests step (list) -->
    <mat-step [stepControl]="interestFormGroup">
      <ng-template matStepLabel>Interests</ng-template>
      <form [formGroup]="interestFormGroup">
        <app-interests [group]="interestFormGroup"></app-interests>
        <div class="flex justify-between mt-4">
          <button mat-button matStepperPrevious>Back</button>
          <button
            mat-button
            color="primary"
            (click)="onSubmit()"
            [disabled]="interestFormGroup.invalid"
          >
            Finish
          </button>
        </div>
      </form>
    </mat-step>

    <!-- Done step -->
    <mat-step>
      <ng-template matStepLabel>Done</ng-template>
      <p>Your resume section is ready.</p>
      <div class="flex justify-between mt-4">
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button (click)="stepper.reset()">Reset</button>
      </div>
    </mat-step>
  </mat-stepper>
</div>
